# 智能主机（立地跳远）详细设计说明书



 



| 文档版本号： | 1.0      | 文档编号：      |            |
| ------------ | -------- | --------------- | ---------- |
| 文档密级：   |          | 归属部门/项目： |            |
| 系统名：     | 智能主机 | 子系统名：      |            |
| 编写人：     | 郑梓笙   | 编写日期：      | 2018-10-17 |

 

 

 

**文档修订记录**

| **版本号** | **修订日期** | **修订人** | **修订说明** | **修订状态** | **审核日期** | **审核人** |
| ---------- | ------------ | ---------- | ------------ | ------------ | ------------ | ---------- |
| v1.0       | 2018-10-17   | 郑梓笙     |              | A            |              |            |
|            |              |            |              |              |              |            |
|            |              |            |              |              |              |            |
|            |              |            |              |              |              |            |
|            |              |            |              |              |              |            |
|            |              |            |              |              |              |            |
|            |              |            |              |              |              |            |
|            |              |            |              |              |              |            |
|            |              |            |              |              |              |            |

修订状态：A--增加，M--修改，D--删除

日期格式：YYYY-MM-DD

## 编写目的 

智能主机客户端（立地跳远）根据《智能主机（立地跳远）详细设计说明书》进行开发。编写本使用说明目的是以便使用者了解本软件的使用范围和使用方法，并为软件的维护和更新提供必要的信息。

## 编写依据

- 产品需求

- [立定跳远协议说明.doc](立定跳远协议说明.doc)

- 具体实现代码

## 

## **参考资料**

| **参考文件**                                                 | **备注** |
| ------------------------------------------------------------ | -------- |
| [立定跳远协议说明.doc](立定跳远协议说明.doc)                 |          |
| [控制主机和采集终端通信协议.docx](控制主机和采集终端通信协议.docx) |          |
| [个人测试模版基类（BasePersonTestActivity）.md]()            |          |
| [个人测试的人脸识别与自由测试基类.md]()                      |          |

## 功能流程

参考[个人测试模版基类（BasePersonTestActivity）.md]()相关文档

基类处理学生检入，立地跳远项目处理与测试设备终端的交互，处理完成终端信息再通知基类显示对应的状态与成绩信息，串口相关信息可参考[串口模块_SerialManager.md]()，其主要**工作流程**如下:
```sequence
父类->立地跳远:检入考生
立地跳远->设备终端:检测设备
设备终端->立地跳远:回复
立地跳远->父类:设置状态
立地跳远->设备终端:开始测试 
设备终端->立地跳远:开始测试回复
设备终端->立地跳远:回复成绩
立地跳远->父类:更新成绩设置状态
立地跳远->设备终端:结束
立地跳远->父类:结束
```

# **详细设计**

## **个人测试**

### 概要说明

用户通过选择测试项目（立地跳远）点击测试进入系统，同时可以在测试界面进入自由测试，项目设置。 

### 实现原理

根据[个人测试模版基类（BasePersonTestActivity）.md]()完成对应的抽象方法，按照[立定跳远协议说明.doc](立定跳远协议说明.doc)检测设备与获取考生成绩

### 提供API

立地跳远设备指令回调处理Handler

``` java

StandHandler
 /***测试状态  UN_STARTED 未测试，START_TEST准备状态 WAIT_RESULT开始测试  TEST_END 测试结束，成功获取成绩*/
    enum TestState {
        UN_STARTED, START_TEST, WAIT_RESULT, TEST_END
    }

case JUMP_SELF_CHECK_RESPONSE://测量垫检测回调
case JUMP_SELF_CHECK_RESPONSE_Simple://测量垫检测通过
case JUMP_START_RESPONSE://开始测试回调
case JUMP_SCORE_RESPONSE://成绩获取回调
case SerialConfigs.JUMP_END_RESPONSE://结束指令回复
```

> 回调中添加了测试状态，为了处理测试结束终端还在回复成绩与在发送测试指令前有回复成绩数据导致数据混乱，在成绩回调只有状态在WAIT_RESULT状态下才开始获取成绩，获取第一个成绩后切换到结束，避免接收多次成绩

### **接口设计**

``` java
	HandlerInterface：立地跳远设备返回数据处理回调接口
	void getDeviceState(BaseDeviceState deviceState);//获取设备状态
	void getResult(BaseStuPair deviceState);//获取成绩
	void CheckDevice(boolean isCheckDevice);//检测设备 true 正常 false 故障
	void StartDevice();//开始测试
	void EndDevice(boolean isFoul, int result);//测试结束 isFoul 是否犯规 	  result成绩 
```
### 注意事项

- 设备使用过程中，请根据设备状态（BaseDeviceState ）设置对应的回调（StandHandler）测试状态


### 主要测试点

1.设备状态是否显示正常

2.学生是否可以检入添加测试

3.测试是否可以获取成绩并LED屏展示

4.测试结束成绩是否有播报，显示，4秒后可重新测试



## **自由测试**

### 概要说明

用户通过选择测试项目（立地跳远）自由测试，相关流程与个人测试相同，区别在于自由测试可以进行循环测试，不做数据处理，无需进行考生检入

### 实现原理

根据[个人测试的人脸识别与自由测试基类.md]()完成对应的抽象方法，按照[立定跳远协议说明.doc](立定跳远协议说明.doc)检测设备与获取成绩

### 主要测试点

1.设备状态是否显示正常 

2.测试是否可以获取成绩并LED屏展示

3.测试结束成绩是否有播报，显示，4秒后可重新测试